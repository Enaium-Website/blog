<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>[LWJGL3 2D教程]#5绘制纹理</title><link rel=stylesheet href=/css/bootstrap.min.css></head><body class="d-flex flex-column justify-content-between min-vh-100"><nav class="navbar bg-light"><div class=container-fluid><a class=navbar-brand href=/><img src=https://simpleicons.org/icons/github.svg alt=Logo width=30 height=24 class="d-inline-block align-text-top">
Enaium's blog</a></div></nav><div style=flex:1><div class=container><div class=card><div class=card-header>[LWJGL3 2D教程]#5绘制纹理</div><div class=card-body><div class=card-text><p>先说原理</p><p>读取一张图片，然后获取图片所有的像素，根据像素的rgba来绘制</p><p>先创建一个<code>Texture</code>类</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span><span style=color:#66d9ef>public</span> <span style=color:#66d9ef>class</span> <span style=color:#a6e22e>Texture</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>private</span> <span style=color:#66d9ef>int</span> id<span style=color:#f92672>;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#a6e22e>Texture</span> <span style=color:#f92672>(</span>String path<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            BufferedImage image <span style=color:#f92672>=</span> ImageIO<span style=color:#f92672>.</span><span style=color:#a6e22e>read</span><span style=color:#f92672>(</span>Texture<span style=color:#f92672>.</span><span style=color:#a6e22e>class</span><span style=color:#f92672>.</span><span style=color:#a6e22e>getResource</span><span style=color:#f92672>(</span>path<span style=color:#f92672>));</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>int</span><span style=color:#f92672>[]</span> pixels <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#66d9ef>int</span><span style=color:#f92672>[</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>()</span> <span style=color:#f92672>*</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>()];</span><span style=color:#75715e>//创建像素列表
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            image<span style=color:#f92672>.</span><span style=color:#a6e22e>getRGB</span><span style=color:#f92672>(</span>0<span style=color:#f92672>,</span> 0<span style=color:#f92672>,</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>(),</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>(),</span> pixels<span style=color:#f92672>,</span> 0<span style=color:#f92672>,</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>());</span><span style=color:#75715e>//获取图片像素
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>            ByteBuffer buffer <span style=color:#f92672>=</span> BufferUtils<span style=color:#f92672>.</span><span style=color:#a6e22e>createByteBuffer</span><span style=color:#f92672>(</span>image<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>()</span> <span style=color:#f92672>*</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>()</span> <span style=color:#f92672>*</span> 4<span style=color:#f92672>);</span><span style=color:#75715e>//创建字节缓冲区，*4是包含alpha *3不包含
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>//遍历图片像素转换为RGBA
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> y <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> y <span style=color:#f92672>&lt;</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>();</span> y<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>for</span> <span style=color:#f92672>(</span><span style=color:#66d9ef>int</span> x <span style=color:#f92672>=</span> 0<span style=color:#f92672>;</span> x <span style=color:#f92672>&lt;</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>();</span> x<span style=color:#f92672>++)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>                    <span style=color:#66d9ef>int</span> pixel <span style=color:#f92672>=</span> pixels<span style=color:#f92672>[</span>y <span style=color:#f92672>*</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>()</span> <span style=color:#f92672>+</span> x<span style=color:#f92672>];</span>
</span></span><span style=display:flex><span>                    Color color <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Color<span style=color:#f92672>(</span>pixel<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>                    buffer<span style=color:#f92672>.</span><span style=color:#a6e22e>put</span><span style=color:#f92672>((</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>)</span> color<span style=color:#f92672>.</span><span style=color:#a6e22e>getRed</span><span style=color:#f92672>());</span><span style=color:#75715e>//像素点的Red
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    buffer<span style=color:#f92672>.</span><span style=color:#a6e22e>put</span><span style=color:#f92672>((</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>)</span> color<span style=color:#f92672>.</span><span style=color:#a6e22e>getGreen</span><span style=color:#f92672>());</span><span style=color:#75715e>//像素点的Green
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    buffer<span style=color:#f92672>.</span><span style=color:#a6e22e>put</span><span style=color:#f92672>((</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>)</span> color<span style=color:#f92672>.</span><span style=color:#a6e22e>getBlue</span><span style=color:#f92672>());</span><span style=color:#75715e>//像素点的Blue
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                    buffer<span style=color:#f92672>.</span><span style=color:#a6e22e>put</span><span style=color:#f92672>((</span><span style=color:#66d9ef>byte</span><span style=color:#f92672>)</span> color<span style=color:#f92672>.</span><span style=color:#a6e22e>getAlpha</span><span style=color:#f92672>());</span><span style=color:#75715e>//像素点的Alpha
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>                <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>            <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            buffer<span style=color:#f92672>.</span><span style=color:#a6e22e>flip</span><span style=color:#f92672>();</span> <span style=color:#75715e>//一定要翻转
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>
</span></span><span style=display:flex><span>            id <span style=color:#f92672>=</span> glGenTextures<span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            glBindTexture<span style=color:#f92672>(</span>GL_TEXTURE_2D<span style=color:#f92672>,</span> id<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>//设置缩放过滤
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            glTexParameteri<span style=color:#f92672>(</span>GL_TEXTURE_2D<span style=color:#f92672>,</span> GL_TEXTURE_MIN_FILTER<span style=color:#f92672>,</span> GL_NEAREST<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>            glTexParameteri<span style=color:#f92672>(</span>GL_TEXTURE_2D<span style=color:#f92672>,</span> GL_TEXTURE_MAG_FILTER<span style=color:#f92672>,</span> GL_NEAREST<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>            <span style=color:#75715e>//发送数据到OpenGL
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>            glTexImage2D<span style=color:#f92672>(</span>GL_TEXTURE_2D<span style=color:#f92672>,</span> 0<span style=color:#f92672>,</span> GL_RGBA<span style=color:#f92672>,</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getWidth</span><span style=color:#f92672>(),</span> image<span style=color:#f92672>.</span><span style=color:#a6e22e>getHeight</span><span style=color:#f92672>(),</span> 0<span style=color:#f92672>,</span> GL_RGBA<span style=color:#f92672>,</span> GL_UNSIGNED_BYTE<span style=color:#f92672>,</span> buffer<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span> <span style=color:#66d9ef>catch</span> <span style=color:#f92672>(</span>IOException e<span style=color:#f92672>)</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>            e<span style=color:#f92672>.</span><span style=color:#a6e22e>printStackTrace</span><span style=color:#f92672>();</span>
</span></span><span style=display:flex><span>        <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>public</span> <span style=color:#66d9ef>void</span> <span style=color:#a6e22e>bind</span><span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        glBindTexture<span style=color:#f92672>(</span>GL_TEXTURE_2D<span style=color:#f92672>,</span> id<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span></code></pre></div><p>接下来开始绘制。</p><p>加载纹理，获取ID。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Texture texture <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> Texture<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;/hero.png&#34;</span><span style=color:#f92672>);</span>
</span></span></code></pre></div><p>绑定纹理绘制，4个顶点和4个坐标。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>glBegin<span style=color:#f92672>(</span>GL_QUADS<span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>texture<span style=color:#f92672>.</span><span style=color:#a6e22e>bind</span><span style=color:#f92672>();</span><span style=color:#75715e>//绑定纹理
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>glTexCoord2f<span style=color:#f92672>(</span>0<span style=color:#f92672>,</span> 0<span style=color:#f92672>);</span><span style=color:#75715e>//坐标1
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>glVertex2d<span style=color:#f92672>(-</span>0<span style=color:#f92672>.</span><span style=color:#a6e22e>5f</span><span style=color:#f92672>,</span> 0<span style=color:#f92672>.</span><span style=color:#a6e22e>5f</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>glTexCoord2f<span style=color:#f92672>(</span>1<span style=color:#f92672>,</span> 0<span style=color:#f92672>);</span><span style=color:#75715e>//坐标2
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>glVertex2d<span style=color:#f92672>(</span>0<span style=color:#f92672>.</span><span style=color:#a6e22e>5f</span><span style=color:#f92672>,</span> 0<span style=color:#f92672>.</span><span style=color:#a6e22e>5f</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>glTexCoord2f<span style=color:#f92672>(</span>1<span style=color:#f92672>,</span> 1<span style=color:#f92672>);</span><span style=color:#75715e>//坐标3
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>glVertex2d<span style=color:#f92672>(</span>0<span style=color:#f92672>.</span><span style=color:#a6e22e>5f</span><span style=color:#f92672>,</span> <span style=color:#f92672>-</span>0<span style=color:#f92672>.</span><span style=color:#a6e22e>5f</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>glTexCoord2f<span style=color:#f92672>(</span>0<span style=color:#f92672>,</span> 1<span style=color:#f92672>);</span><span style=color:#75715e>//坐标4
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>glVertex2d<span style=color:#f92672>(-</span>0<span style=color:#f92672>.</span><span style=color:#a6e22e>5f</span><span style=color:#f92672>,</span> <span style=color:#f92672>-</span>0<span style=color:#f92672>.</span><span style=color:#a6e22e>5f</span><span style=color:#f92672>);</span>
</span></span><span style=display:flex><span>glEnd<span style=color:#f92672>();</span>
</span></span></code></pre></div></div><div class="d-flex justify-content-between"><a class=text-reset href=https://blog.enaium.cn/post/2021-2-21-lwjgl3-2d%E6%95%99%E7%A8%8B#4%E6%8C%89%E9%94%AE/>[LWJGL3 2D教程]#4按键</a>
<a class=text-reset href=https://blog.enaium.cn/post/2021-2-22-cf4m%E6%95%99%E7%A8%8B#5%E6%89%A9%E5%B1%95/>[CF4M教程]#5扩展</a></div></div></div></div></div><footer class="p-5 bg-dark text-white text-center"><div class=container><p class=lead>Copyright &copy; 2022 Enaium</p></div></footer><script src=/js/bootstrap.bundle.min.js></script></body></html>